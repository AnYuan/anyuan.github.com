<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>UIApplicationDelegate 启动选项介绍 | Anyuan&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="1- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions&amp;#10;&amp;#123;&amp;#10;  // Override point for customization after application launch.&amp;#10;  retur">
<meta property="og:type" content="article">
<meta property="og:title" content="UIApplicationDelegate 启动选项介绍">
<meta property="og:url" content="http://yoursite.com/2014/03/05/UIApplicationDelegate-启动选项介绍/index.html">
<meta property="og:site_name" content="Anyuan's blog">
<meta property="og:description" content="1- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions&amp;#10;&amp;#123;&amp;#10;  // Override point for customization after application launch.&amp;#10;  retur">
<meta property="og:updated_time" content="2021-01-31T08:27:44.290Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="UIApplicationDelegate 启动选项介绍">
<meta name="twitter:description" content="1- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions&amp;#10;&amp;#123;&amp;#10;  // Override point for customization after application launch.&amp;#10;  retur">
  
    <link rel="alternative" href="/atom.xml" title="Anyuan&#39;s blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  

</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Anyuan&#39;s blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">home</a>
        
          <a class="main-nav-link" href="/archives">archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-UIApplicationDelegate-启动选项介绍" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/03/05/UIApplicationDelegate-启动选项介绍/" class="article-date">
  <time datetime="2014-03-05T08:19:36.000Z" itemprop="datePublished">2014-03-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      UIApplicationDelegate 启动选项介绍
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions&#10;&#123;&#10;  // Override point for customization after application launch.&#10;  return YES;&#10;&#125;&#10;&#10;- (void)applicationWillResignActive:(UIApplication *)application&#10;&#123;&#10;  // Sent when the application is about to move from active to inactive state. This can occur for certain types of temporary interruptions (such as an incoming phone call or SMS message) or when the user quits the application and it begins the transition to the background state.&#10;  // Use this method to pause ongoing tasks, disable timers, and throttle down OpenGL ES frame rates. Games should use this method to pause the game.&#10;&#125;&#10;&#10;- (void)applicationDidEnterBackground:(UIApplication *)application&#10;&#123;&#10;  // Use this method to release shared resources, save user data, invalidate timers, and store enough application state information to restore your application to its current state in case it is terminated later.&#10;  // If your application supports background execution, this method is called instead of applicationWillTerminate: when the user quits.&#10;&#125;&#10;&#10;- (void)applicationWillEnterForeground:(UIApplication *)application&#10;&#123;&#10;  // Called as part of the transition from the background to the inactive state; here you can undo many of the changes made on entering the background.&#10;&#125;&#10;&#10;- (void)applicationDidBecomeActive:(UIApplication *)application&#10;&#123;&#10;  // Restart any tasks that were paused (or not yet started) while the application was inactive. If the application was previously in the background, optionally refresh the user interface.&#10;&#125;&#10;&#10;- (void)applicationWillTerminate:(UIApplication *)application&#10;&#123;&#10;  // Called when the application is about to terminate. Save data if appropriate. See also applicationDidEnterBackground:.&#10;&#125;</span><br></pre></td></tr></table></figure>
<p>每个iOS app的入口都是</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions</span><br></pre></td></tr></table></figure>
<p>当app启动完成，准备运行时，application会调用自己的这个代理方法。</p>
<p>一个app除了点击图标进行启动，还有一些其他方式调用一个app。区别不同启动方式，就需要用到launchOptions. 与userInfo 字典相似，<code>-application:didFinishLaunchingWithOptions:</code> 可以通过launchOptions获取启动信息的key。</p>
<p><strong>通过URL启动</strong></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@&#34;app://...&#34;]];</span><br></pre></td></tr></table></figure>
<p><a href="http://URL" target="_blank" rel="external">http://URL</a> 会调用Safari， mailto://URL 会打开邮箱， tel://URL 会拨打电话。</p>
<p>这种情况下<code>launchOptions</code> 为<code>UIApplicationLaunchOptionsURLKey</code></p>
<p>app通过URL调用时，还可以有一些系统信息。 当通过<code>UIDocumentInteractionController</code> 或者 AirDrop 调用时，<code>launchedOptions</code> 会被设置为：</p>
<p><code>UIApplicationLaunchOptionsSourceApplicationKey:</code> key值是一个NSString，表示要调用你app的app bundle ID</p>
<p><code>UIApplicationLaunchOptionsAnnotationKey:</code> key可以存储property-list 对象。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSURL *fileURL = [[NSBundle mainBundle] URLForResource:@&#34;Document&#34; withExtension:@&#34;pdf&#34;];&#10;if (fileURL) &#123;&#10;  UIDocumentInteractionController *documentInteractionController =&#10;  [UIDocumentInteractionController interactionControllerWithURL:fileURL];&#10;&#10;  documentInteractionController.annotation = @&#123;@&#34;foo&#34;: @&#34;bar&#34;&#125;;&#10;  [documentInteractionController setDelegate:self];&#10;  [documentInteractionController presentPreviewAnimated:YES];&#10;&#125;</span><br></pre></td></tr></table></figure>
<p><strong>推送消息调用</strong></p>
<p><strong>远程推送</strong></p>
<p>远程推送消息调用时，launch option 会是 <code>UIApplicationLaunchOptionsRemoteNotificationKey</code>，</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (BOOL)application:(UIApplication *)applicationdidFinishLaunchingWithOptions:(NSDictionary *)launchOptions&#10;&#123;&#10;  // ...&#10;&#10;    if (launchOptions[UIApplicationLaunchOptionsRemoteNotificationKey]) &#123;&#10;       [self application:application didReceiveRemoteNotification:launchOptions[UIApplicationLaunchOptionsRemoteNotificationKey]];&#10;    &#125;&#10;&#125;</span><br></pre></td></tr></table></figure>
<p><strong>本地推送</strong></p>
<p>本地推送launch options 会是 <code>UIApplicationLaunchOptionsLocalNotificationKey</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@import AVFoundation;&#10;@interface AppDelegate ()&#10;@property (readwrite, nonatomic, assign) SystemSoundID localNotificationSound;&#10;@end&#10;&#10;- (void)application:(UIApplication *)application didReceiveLocalNotification:(UILocalNotification *)notification&#10;&#123;     &#10;    if (application.applicationState == UIApplicationStateActive) &#123;         &#10;   UIAlertView *alertView = [[UIAlertView alloc] initWithTitle:notification.alertAction                                                               message:notification.alertBody                                                                 delegate:nil&#10;                                             cancelButtonTitle:NSLocalizedString(@&#34;OK&#34;, nil)                                                otherButtonTitles:nil];         &#10;   if (!self.localNotificationSound) &#123;             &#10;        NSURL *soundURL = [[NSBundle mainBundle] URLForResource:@&#34;Sosumi&#34;                                                                        withExtension:@&#34;wav&#34;];             &#10;     AudioServicesCreateSystemSoundID((__bridge CFURLRef)soundURL, &#38;_localNotificationSound);      &#125;         &#10;    AudioServicesPlaySystemSound(self.localNotificationSound);         &#10;    [alertView show];     &#10;  &#125;&#10;&#125;&#10;- (void)applicationWillTerminate:(UIApplication *)application &#123;     &#10;  if (self.localNotificationSound) &#123;         &#10;      AudioServicesDisposeSystemSoundID(self.localNotificationSound);     &#10;  &#125;&#10;&#125;</span><br></pre></td></tr></table></figure>
<p><strong>位置事件调用</strong></p>
<p>当由手机位置变动，调用app时，launch option 会是 <code>UIApplicationLaunchOptionsLocationKey</code>, key 是一个NSNumber 包含一个Boolean。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@import CoreLocation;&#10;@interface AppDelegate () &#60;CLLocationManagerDelegate&#62;&#10;@property (readwrite, nonatomic, strong) CLLocationManager *locationManager;&#10;@end&#10;&#10;- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions &#123;     &#10;  // ...     &#10;  if (![CLLocationManager locationServicesEnabled]) &#123;         &#10;  [[[UIAlertView alloc] initWithTitle:NSLocalizedString(@&#34;Location Services Disabled&#34;, nil)                                  message:NSLocalizedString(@&#34;You currently have all location services for this device disabled. If you proceed, you will be asked to confirm whether location services should be reenabled.&#34;, nil)                                    &#10;                             delegate:nil                           &#10;                    cancelButtonTitle:NSLocalizedString(@&#34;OK&#34;, nil)                                                otherButtonTitles:nil] show];     &#10;   &#125;&#10;   else &#123;         &#10;       self.locationManager = [[CLLocationManager alloc] init];         &#10;       self.locationManager.delegate = self;         &#10;       [self.locationManager startMonitoringSignificantLocationChanges];     &#10;   &#125;     &#10;   if (launchOptions[UIApplicationLaunchOptionsLocationKey]) &#123;         &#10;   [self.locationManager startUpdatingLocation];     &#10;   &#125;&#10;&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Newsstand</strong></p>
<p>launch option 会是 <code>UIApplicationLaunchOptionsNewsstandDownloadsKey</code>, 提示用户有新的Newsstand可以下载</p>
<p>蓝牙调用</p>
<p>iOS 7 中蓝牙分主从关系，所以对应的launch option key有两种</p>
<p><code>UIApplicationLaunchOptionsBluetoothCentralsKey</code></p>
<p><code>UIApplicationLaunchOptionsBluetoothPeripheralsKey</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#10;@import CoreBluetooth;&#10;@interface AppDelegate () &#60;CBCentralManagerDelegate&#62;&#10;@property (readwrite, nonatomic, strong) CBCentralManager *centralManager;&#10;@end&#10;&#10;self.centralManager = [[CBCentralManager alloc] initWithDelegate:self&#10;                                                         queue:nil&#10;                                                         options:@&#123;CBCentralManagerOptionRestoreIdentifierKey:(launchOptions[UIApplicationLaunchOptionsBluetoothCentralsKey] ?: [[NSUUID UUID] UUIDString])&#125;];&#10;if (self.centralManager.state == CBCentralManagerStatePoweredOn) &#123;     &#10;  static NSString * const UID = @&#34;7C13BAA0-A5D4-4624-9397-15BF67161B1C&#34;; // generated with `$ uuidgen`     &#10;  NSArray *services = @[[CBUUID UUIDWithString:UID]];     &#10;  NSDictionary *scanOptions = @&#123;CBCentralManagerScanOptionAllowDuplicatesKey:@YES&#125;;     &#10;  [self.centralManager scanForPeripheralsWithServices:services options:scanOptions];&#10;&#125;</span><br></pre></td></tr></table></figure>
<p><a href="http://nshipster.com/launch-options/" target="_blank" rel="external">参考链接</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2014/03/05/UIApplicationDelegate-启动选项介绍/" data-id="ckovhcvjy001o85rcfit7bteq" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2014/04/06/iOS-Block实现探究/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          iOS Block实现探究
        
      </div>
    </a>
  
  
    <a href="/2014/02/19/iOS7-nested-push-animation-can-result-in-corrupted/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">iOS7 nested push animation can result in corrupted</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/">C</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQLite/">SQLite</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Swift/">Swift</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Unix/">Unix</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iOS/">iOS</a><span class="tag-list-count">20</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/life/">life</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux-archlinux/">linux, archlinux</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/phonegap/">phonegap</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/programming/">programming</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/算法/">算法</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/编辑器配置文件/">编辑器配置文件</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/读书/">读书</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/C/" style="font-size: 16.67px;">C</a> <a href="/tags/SQLite/" style="font-size: 10px;">SQLite</a> <a href="/tags/Swift/" style="font-size: 10px;">Swift</a> <a href="/tags/Unix/" style="font-size: 10px;">Unix</a> <a href="/tags/iOS/" style="font-size: 20px;">iOS</a> <a href="/tags/life/" style="font-size: 10px;">life</a> <a href="/tags/linux/" style="font-size: 13.33px;">linux</a> <a href="/tags/linux-archlinux/" style="font-size: 10px;">linux, archlinux</a> <a href="/tags/phonegap/" style="font-size: 10px;">phonegap</a> <a href="/tags/programming/" style="font-size: 10px;">programming</a> <a href="/tags/算法/" style="font-size: 10px;">算法</a> <a href="/tags/编辑器配置文件/" style="font-size: 10px;">编辑器配置文件</a> <a href="/tags/读书/" style="font-size: 10px;">读书</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">三月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">一月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">十二月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">十月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">九月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">八月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">十二月 2014</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/08/">八月 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/04/">四月 2014</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/03/">三月 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/02/">二月 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/12/">十二月 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/11/">十一月 2013</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/10/">十月 2013</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/08/">八月 2013</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/07/">七月 2013</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/06/">六月 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/05/">五月 2013</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/03/">三月 2013</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/01/">一月 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/12/">十二月 2012</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/11/">十一月 2012</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/05/">五月 2012</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/03/29/Reading-Note-of-Book-Deep-Work/">Reading Note of Book: Deep Work</a>
          </li>
        
          <li>
            <a href="/2021/01/31/又开始写博客了/">又开始写博客了</a>
          </li>
        
          <li>
            <a href="/2015/12/26/iOS应用文件路径简介-md/">iOS应用文件路径简介</a>
          </li>
        
          <li>
            <a href="/2015/10/02/Protocol-Extensions/">Protocol Extensions</a>
          </li>
        
          <li>
            <a href="/2015/09/13/iOS-7-9-新特性总结/">iOS 7 - 9 新特性总结</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 Anyuan<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">home</a>
  
    <a href="/archives" class="mobile-nav-link">archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>